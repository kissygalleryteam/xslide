KISSY.add("kg/xslide/3.0.0/index",["kg/xscroll/3.0.0/util","kg/xscroll/3.0.0/base","kg/xscroll/3.0.0/xscroll"],function(e,t){var r=t("kg/xscroll/3.0.0/util"),i=t("kg/xscroll/3.0.0/base"),n=t("kg/xscroll/3.0.0/xscroll"),o=0,s=function(e){s.superclass.constructor.call(this,e),this.init(e)};return r.extend(s,i,{direction:"left",transform:function(e,t){var r=["-webkit-","-moz-","-o-",""];for(var i in t)for(var n in r)e.style[r[n]+"transform"]=i+t[i]},init:function(e){var t=this;t.userConfig=r.mix({autoRender:!0,autoSlide:!1,timeout:4e3,duration:400,easing:"ease",adaptive:!0,crousel:!1,clsPrefix:"xslide-"},e),t.renderTo=document.querySelector(e.renderTo),t.xscroll=new n({renderTo:t.renderTo,scrollbarX:!1,scrollbarY:!1,lockX:!1,lockY:!0}),t.itemCls=t.userConfig.clsPrefix+"item",t.navCls=t.userConfig.clsPrefix+"nav",t.navItemCls=t.userConfig.clsPrefix+"nav-item",t.userConfig.autoRender&&t.render()},render:function(){var e=this,t=e.userConfig;if(e.renderTo){var i=(e.items=e.renderTo.querySelectorAll("."+e.itemCls),e.nav=e.renderTo.querySelector("."+e.navCls));i||(i=document.createElement("ul"),r.addClass(i,e.navCls),e.renderTo.appendChild(i));var n,s=e.itemNum=e.items.length,l=t.width||e.renderTo.offsetWidth||300,u=t.height||e.renderTo.offsetHeight||50,c=e.itemWidth=t.itemWidth||l,d=t.itemHeight||u;if(e.curIndex=0,o=0,s){if(2>=s&&(t.crousel=!1),t.crousel){for(var a=0;s>a;a++)e.items[a].style.display="block",e.items[a].style.width=c+"px",e.items[a].style.height=d+"px",e.items[a].style.position="absolute";e.xscroll.userConfig.boundryCheck=!1}else e.xscroll.userConfig.boundryCheck=!0;if(e.xscroll.render(),e.layWidth=e.itemNum*c,!i.querySelectorAll("li").length||s!=i.querySelectorAll("li").length){for(var m="",a=1;a<=e.itemNum;a++)m+="<li class='"+e.navItemCls+"'>"+a+"</li>";i.innerHTML=m}if(n=e.navItems=i.querySelectorAll("li"),e._bindEvt(),e.userConfig.crousel){for(var a=0;s>a;a++)e.put(a,a);e.put(s-1,-1)}e.animTo(0),e.userConfig.autoSlide&&e.autoSlide()}}},pop:function(e){var t=e.length;return e[t-1]},getPrev:function(){var e=this,t=e.curIndex;return e.$items.item((t-1+e.itemNum)%e.itemNum)},getNext:function(){var e=this,t=e.curIndex;return e.$items.item((t+1)%e.itemNum)},getCurrent:function(){var e=this,t=e.curIndex;return e.$items.item(t)},getItem:function(e){return this.$items.item(0>e?e%self.itemNum+self.itemNum:e%self.itemNum)},_bindEvt:function(){var e=this;if(!e._isEvtBind){e._isEvtBind=!0;var t,r=e.xscroll;r.mc.on("panstart",function(t){e.direction=2==t.direction?"left":"right",e.__enableAutoSlide=!1}),r.mc.on("panend",function(r){if(1==r.direction)e.animTo(e.judgePos());else{{e.direction=2==r.direction?"left":"right"}t=e.userConfig.crousel?"right"==e.direction?o-1:o+1:"right"==e.direction?e.curIndex-1:e.curIndex+1,e.animTo(t)}setTimeout(function(){e.__enableAutoSlide=!0},2e3)}),e.on("beforeslide",e.computePos,e)}},animTo:function(e,t,i,n){var s=this,l=s.itemWidth,u=s.itemNum;s.userConfig.crousel&&(o=e),0>e?e=0:e>s.itemNum-1&&(e=s.itemNum-1);var c=s.userConfig.crousel?l*o:l*e;s.xscroll.scrollLeft(c,t||s.userConfig.duration,i||s.userConfig.easing,function(){n&&n(),s.trigger("afterslide",{curIndex:s.curIndex})}),s.curIndex=s.userConfig.crousel?0>o%u?u+o%u:o%u:e;for(var d=0;d<s.itemNum;d++)r.removeClass(s.navItems[d],"current"),r.removeClass(s.items[d],"current");r.addClass(s.navItems[s.curIndex],"current"),r.addClass(s.items[s.curIndex],"current"),s.trigger("beforeslide",{direction:s.direction})},judgePos:function(){var e=this,t=e.itemNum,r=e.itemWidth,i=e.xscroll.getScrollLeft();return e.direction=i/r-Math.floor(i/r)>=.5?"left":"right",o=Math.round(i/r),e.curIndex=0>o%t?t+o%t:o%t,o},computePos:function(){var e=this;e.userConfig.crousel&&("right"==e.direction?e.put(e.curIndex-1,o-1):"left"==e.direction&&e.put(e.curIndex+1,o+1))},put:function(e,t){var r=this,i=r.itemNum,n=r.itemWidth;0>e?e=i-1:e>i-1&&(e=0),r.transform(r.items[e],{translateX:"("+t*n+"px) translateZ(0px)"})},autoSlide:function(){var e=this,t=e.curIndex;e.itemNum<2||(e.__enableAutoSlide=!0,clearInterval(e.__itv),e.__itv=setInterval(function(){e.__enableAutoSlide&&(e.direction="left",t=e.userConfig.crousel?o:e.curIndex,t++,!e.userConfig.crousel&&t>=e.itemNum&&(t=0),e.animTo(t))},e.userConfig.timeout))},destroy:function(){var e=this;clearInteval(e.__itv),e.off("beforeslide",e.computePos),delete e}}),s});